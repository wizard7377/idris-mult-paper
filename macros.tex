


\NewDocumentCommand{\fn}{e{_}omm}{{\ensuremath{%
			\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\to}{\to_{#1}}% 
			#4%
}}}
\NewDocumentCommand{\fa}{e{_}omm}{{\ensuremath{%
			\forall\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\to}{\to_{#1}}% 
			#4%
}}}
%Pair types
\NewDocumentCommand{\sg}{e{_}omm}{{\ensuremath{%
			\forall\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\times}{\times_{#1}}% 
			#4%
}}}
\NewDocumentCommand{\et}{e{_}omm}{{\ensuremath{%
			\IfNoValueTF{#1}{\exists}{\exists_{#1}}% 
			\forall\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			#4%
}}}
\NewDocumentCommand{\sfn}{ O{1} O{\_} m m }{{\ensuremath{%
			\ifstrequal{#2}{\_}{#3}{(#2 : #3)}%
			\ifstrequal{#1}{*}{\to}{\to_{#1}}% 
			#4%
}}}

\NewDocumentCommand{\sfa}{ O{1} O{\_} m m }{{\ensuremath{%
			\forall\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
			\ifstrequal{#1}{*}{\to}{\to_{#1}} #4%
}}}
\NewDocumentCommand{\iarg}{m}{{\ensuremath{\{#1\}}}}
\NewDocumentCommand{\farg}{m}{{\ensuremath{#1}}}

\NewDocumentCommand{\afa}{e{_}omm}{{\ensuremath{%
			\forall\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\Rightarrow}{\Rightarrow_{#1}}% 
			#4%
}}}
\NewDocumentCommand{\safa}{e{_}omm}{{\ensuremath{%
			\forall\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\to}{\to_{#1}}% 
			#4%
}}}
%\def\afa#1#2 :#3.#4 {{\ensuremath{%
%			\forall\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
%			\ifstrequal{#1}{*}{\Rightarrow}{\Rightarrow_{#1}} #4%
%}}}

\def\tp#1 #2 :#3.#4 {{\ensuremath{%
			\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
			\ifstrequal{#1}{*}{{*}}{{*}_{#1}} #4%
}}}
\def\te#1#2:#3.#4 {{\ensuremath{%
			\ifstrequal{#1}{*}{\exists}{\exists_{#1}}% 
			\ifstrequal{#2}{\_}{#3}{(#2 : #3)} . #4%
}}}
\def\for#1:#2.#3 {{\ensuremath{\fa0 {#1}:{#2}.{#3} }}}

%\def\tw#1#2#3 {{\ensuremath{\tomega \ #1 \ #2 \ #3}}}
%If star, custom val (second), if otherwise with underscore, expand
\NewDocumentCommand{\tw}{se{_}mmm}{\ensuremath{%
	\IfBooleanTF{#1}
		{{\fn_1[#3]{\nat}{M \ #3 \ #4 \ #5 }}}%
		{%
		\IfNoValueTF{#2}
			{\Omega \ #3 \ #4 \ #5}%
			{\fn_1[#2]{\nat}{M \ (\code{Eval} \ #3 \ #2) \ #4 \ #5 }}%
		}%
}}

