\newcommand{\funwith}[1][\ensuremath{*}]{\ensuremath{\to_#1}}
\newcommand{\proc}{\ensuremath{\gls{sym:lmap}}}
\newcommand{\abst}{\ensuremath{\gls{sym:efun}}}
\newcommand{\mz}{\gls{cons:exhaust}}
\newcommand{\ms}{\gls{cons:provide}}
\newcommand{\nsum}{\gls{cons:provide}}
\newcommand{\tmu}{\gls{type:tmu}}
\def\tm#1#2#3 {\ensuremath{\tmu \ #1 \ #2 \ #3}}
\NewDocumentCommand{\stm}{ m m m }{{\ensuremath{\tmu \ #1 \ #2 \ #3}}}
\newcommand{\tomega}{\gls{type:Omega}}

\newcommand{\mcombine}{\ensuremath{\otimes}} %TODO: Link to gloss
\newcommand{\nat}{\gls{type:nats}}
\newcommand{\tpe}{\gls{type:tpe}}
\newcommand{\tset}{\ensuremath{\text{Part}}}
\newcommand{\redux}{\ensuremath{\vartriangleright}}
%\newcommand{\fa}[1]{{\gls{sym:forall}}_{#1}}
%\def\for#1:#2.#3{\ensuremath{\{#1 : #2\} \gls{sym:efun} #3}}
%\newcommand{\fa}[1]{\ensuremath{#1 \gls{sym:forall}}}
\def\ufun#1#2{{\ensuremath{#1 \gls{sym:efun} #2}}}
\newcommand{\liso}{\ensuremath{\cong_1}}
\newcommand{\nuse}[2]{\ensuremath{{#1}\#{#2}}}
\newcommand{\lpair}{\ensuremath{\times^1}} %TODO: Link to gloss
\newcommand{\ltup}{\ensuremath{*^1}} %TODO: Link to gloss
\newcommand{\liniso}{\ensuremath{\cong_{\multimap}}}
\newcommand{\carat}{\text{\textsuperscript{$\wedge$}}}
\newcommand{\ccarat}{\carat\carat} %TODO: Find a less stupid way to do this
\newcommand{\lincomp}[1][]{\ensuremath{\ifblank{#1}{\circ^1}{\circ^1_{#1}}}}
\newcommand{\ecomp}[1][]{\ensuremath{\ifblank{#1}{\circ^{\exists_1}}{\circ^{\exists_1}_{#1}}}}
\newcommand{\eomega}[4][n]{\ensuremath{{\fn1 #1 : \nat . \afa0 {\code{prf}} : {(#2 \ #1)} . {\tmu \ #1 \ #3 \ #4}}}}
\newcommand{\deq}{\ensuremath{:=}}
\newcommand{\wrap}[1]{{\ensuremath{(#1)}}}
\newcommand{\expexi}[4][n]{\ensuremath{\te1 #4 : #3 . \eomega[#1]{#2}{#3}{#4}}}
\newcommand{\subform}{\sqsubseteq}
\NewDocumentCommand{\fn}{e{_}omm}{{\ensuremath{%
			\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\to}{\to_{#1}}% 
			#4%
}}}
\NewDocumentCommand{\fa}{e{_}omm}{{\ensuremath{%
			\forall\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\to}{\to_{#1}}% 
			#4%
}}}
\long\def\oldfn#1 #2 :#3.#4 {{\ensuremath{%
			\ifstrequal{#2}{\_}{#3}{(#2 : #3)}%
			\ifstrequal{#1}{*}{\to}{\to_{#1}}% 
			#4%
}}}
\NewDocumentCommand{\sfn}{ O{1} O{\_} m m }{{\ensuremath{%
			\ifstrequal{#2}{\_}{#3}{(#2 : #3)}%
			\ifstrequal{#1}{*}{\to}{\to_{#1}}% 
			#4%
}}}

\NewDocumentCommand{\sfa}{ O{1} O{\_} m m }{{\ensuremath{%
			\forall\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
			\ifstrequal{#1}{*}{\to}{\to_{#1}} #4%
}}}
\NewDocumentCommand{\iarg}{m}{{\ensuremath{\{#1\}}}}
\NewDocumentCommand{\farg}{m}{{\ensuremath{#1}}}

\NewDocumentCommand{\afa}{e{_}omm}{{\ensuremath{%
			\forall\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\Rightarrow}{\Rightarrow_{#1}}% 
			#4%
}}}
\NewDocumentCommand{\safa}{e{_}omm}{{\ensuremath{%
			\forall\IfNoValueTF{#2}{#3}{(#2 : #3)}%
			\IfNoValueTF{#1}{\to}{\to_{#1}}% 
			#4%
}}}
%\def\afa#1#2 :#3.#4 {{\ensuremath{%
%			\forall\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
%			\ifstrequal{#1}{*}{\Rightarrow}{\Rightarrow_{#1}} #4%
%}}}

\def\oldfa#1#2 :#3.#4 {{\ensuremath{%
			\forall\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
			\ifstrequal{#1}{*}{\to}{\to_{#1}} #4%
}}}
\def\oldafa#1#2 :#3.#4 {{\ensuremath{%
			\forall\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
			\ifstrequal{#1}{*}{\Rightarrow}{\Rightarrow_{#1}} #4%
}}}
\def\oldsg#1 #2 :#3.#4 {{\ensuremath{%
			\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
			\ifstrequal{#1}{*}{\times}{\times_{#1}} #4%
}}}
\def\tp#1 #2 :#3.#4 {{\ensuremath{%
			\ifstrequal{#2}{\_}{#3}{(#2 : #3)}% 
			\ifstrequal{#1}{*}{{*}}{{*}_{#1}} #4%
}}}
\def\te#1#2:#3.#4 {{\ensuremath{%
			\ifstrequal{#1}{*}{\exists}{\exists_{#1}}% 
			\ifstrequal{#2}{\_}{#3}{(#2 : #3)} . #4%
}}}
\def\for#1:#2.#3 {{\ensuremath{\fa0 {#1}:{#2}.{#3} }}}
\def\ident #1 {\ensuremath{\texttt{#1}}\xspace}
\def\sigil #1 {\ensuremath{#1}\xspace}
%\def\tw#1#2#3 {{\ensuremath{\tomega \ #1 \ #2 \ #3}}}
%If star, custom val (second), if otherwise with underscore, expand
\NewDocumentCommand{\tw}{se{_}mmm}{\ensuremath{%
	\IfBooleanTF{#1}
		{{\fn_1[#3]{\nat}{M \ #3 \ #4 \ #5 }}}%
		{%
		\IfNoValueTF{#2}
			{\Omega \ #3 \ #4 \ #5}%
			{\fn_1[#2]{\nat}{M \ (\code{Eval} \ #3 \ #2) \ #4 \ #5 }}%
		}%
}}
\def\peq{\ensuremath{=_?}}
\def\omegapred{\ensuremath{\Omega_{\texttt{Pred}}}}
\def\omegaproj{\ensuremath{\Omega_{\texttt{Proj}}}}
%\newenvironment{idris}[2][]{%
	%	\begin{listing} \ifblank{#1}{}{\label{#1}} \ifblank{#2}{}{\caption{#2}} \VerbatimEnvironment\begin{minted}{idris} } 
		% { \end{minted} \end{listing} }
	
\todostyle{citation}{color=green!25,inlinewidth=3cm,inline, noinlinepar,nolist}
\todostyle{missingcode}{color=red!25,inlinewidth=3cm,inline, noinlinepar,nolist}
\todostyle{proof}{color=blue!50}
\todostyle{finish}{color=orange!50}
\todostyle{cleanup}{color=yellow!50}
%\usepackage{xspace}
\NewDocumentCommand{\code}{m}{{\ensuremath{\mathtt{#1}\xspace}}}
\NewDocumentCommand{\feval}{mm}{\ensuremath{\code{Eval} #1 #2 }}
%\newcommand{\code}[1]{\ensuremath{\mathtt{#1}\xspace}}
%\newmintinline[code]{idris}{}
\def\needcite{{\todo[citation]{Need citation}}}
\def\needciteof #1 {{\todo[citation]{Need citation for #1}}}
\def\missingcode{{\todo[missingcode]{Need code}}}
\def\expandthis{{\todo[cleanup]{Expand more on this}}}
\def\finishthis{{\todo[finish]{Finish this}}}
\def\marker #1 {{\todo[missingcode]{#1}}}
\def\pred#1{{\ensuremath{\code{Pred} \ #1}}}
\def\granule{Granule}
\def\idris{Idris}
\def\thislib{\code{idris-mult}\ref{sec:this_lib}}
\newcommand{\set}[1]{\ensuremath{\code{Set}\xspace#1}}

\def\vform{{\code{Form}}}
\def\veval{{\code{Eval}}}
\newcommand{\seq}{\ensuremath{=_{\code{Set}}}}
\newcommand{\sunion}{\ensuremath{\cup_{\code{Set}}}}
\newcommand{\sinter}{\ensuremath{\cap_{\code{Set}}}}
\newcommand{\sfalse}{\ensuremath{\bot_{\code{Set}}}}
\newcommand{\strue}{\ensuremath{\top_{\code{Set}}}}
\newcommand{\selem}{\ensuremath{\in_{\code{Set}}}}
